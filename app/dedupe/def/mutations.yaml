id: https://example.org/dedupe/mutations
name: dedupe-mutations-schema
title: Dedupe Mutations Data Model
description: >-
  LinkML schema for mutation objects that define inputs and outputs for
  storing events in the event sourcing system.

prefixes:
  linkml: https://w3id.org/linkml/
  dedupe: https://example.org/dedupe/

default_prefix: dedupe
default_range: string

imports:
  - linkml:types
  - events
  - models
  - ../../../pkg/dizzy/src/dizzy/def/mutations

classes:

  EventRecordInput:
    description: >-
      Input parameters for storing an event record
    is_a: MutationInput
    attributes:
      event:
        description: The domain event to store
        required: true
        range: DomainEvent

  EventRecord:
    description: >-
      Result of storing an event record
    is_a: Mutation
    attributes:
      event_hash:
        description: SHA256 hash of the event (content-addressable primary key)
        required: true
        range: string
      event_type:
        description: Class name of the event (e.g., "TestMessage", "FileItemScanned")
        required: true
        range: string
      event:
        description: The original event that was stored
        required: true
        range: DomainEvent

  MountPartitionInput:
    description: >-
      Input parameters for mounting a partition at a specific mount point
    is_a: MutationInput
    attributes:
      partition:
        description: The partition to mount
        required: true
        range: Partition
      mount_point:
        description: The mount point path where partition should be mounted
        required: true
        range: string

  MountPartition:
    description: >-
      Result of attempting to mount a partition
    is_a: Mutation
    attributes:
      success:
        description: Whether the mount operation succeeded
        required: true
        range: boolean
      partition_uuid:
        description: UUID of the partition that was mounted (or attempted)
        required: true
        range: string
      mount_point:
        description: The mount point path used
        required: true
        range: string
      error_message:
        description: Error message if the mount failed
        required: false
        range: string

  AppendToManifestInput:
    description: >-
      Input parameters for appending a file entry to a partition manifest
    is_a: MutationInput
    attributes:
      partition_uuid:
        description: UUID of the partition containing this file
        required: true
        range: string
      path:
        description: Full path to the file within the partition
        required: true
        range: string
      cas_id:
        description: CAS identity (version + hash) of the stored content
        required: true
        range: string
      content_hash:
        description: Hash of the file contents
        required: true
        range: string
      size:
        description: Size of the file in bytes
        required: true
        range: integer

  AppendToManifest:
    description: >-
      Result of appending a file entry to a partition manifest CSV
    is_a: Mutation
    attributes:
      success:
        description: Whether the append operation succeeded
        required: true
        range: boolean
      manifest_path:
        description: Path to the manifest file that was updated
        required: true
        range: string
      error_message:
        description: Error message if the append failed
        required: false
        range: string
