id: https://example.org/dedupe/mutations
name: dedupe-mutations-schema
title: Dedupe Mutations Data Model
description: >-
  LinkML schema for mutation objects that define inputs and outputs for
  storing events in the event sourcing system.

prefixes:
  linkml: https://w3id.org/linkml/
  dedupe: https://example.org/dedupe/

default_prefix: dedupe
default_range: string

imports:
  - linkml:types

classes:
  MutationInput:
    description: >-
      Base class for all mutation input parameter objects
    abstract: true

  Mutation:
    description: >-
      Base class for all mutation result objects
    abstract: true

  EventRecordInput:
    description: >-
      Input parameters for storing an event record
    is_a: MutationInput
    attributes:
      event_type:
        description: Fully qualified class name of the event (for deserialization)
        required: true
        range: string
      event_data:
        description: The serialized domain event data (as JSON/dict)
        required: true
        range: string
      source:
        description: Optional metadata about where this event originated (lambda_id, command_id, etc)
        required: false
        range: string

  EventRecord:
    description: >-
      Result of storing an event record, containing the content hash and timestamp
    is_a: Mutation
    attributes:
      event_hash:
        description: SHA256 hash of the event_data (content-addressable primary key)
        required: true
        range: string
      event_type:
        description: Fully qualified class name of the event
        required: true
        range: string
      timestamp:
        description: When this event was first recorded in the store
        required: true
        range: datetime
      was_duplicate:
        description: True if this event already existed (idempotent storage)
        required: true
        range: boolean
